"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[688],{1688:function(t,e,s){s.r(e),s.d(e,{default:function(){return S}});var i=s(641),a=s(33),r=s(3751);const o=(0,i.Lk)("header",{class:"p-5 text-center header-background bg"},[(0,i.Lk)("h1",{class:"display-1 fw-bold"},"Products")],-1),l={class:"container py-lg-5"},c={class:"row mx-0"},d={class:"col-lg-3 gy-4"},u={class:"sticky-top",style:{top:"96px"}},n={class:"list-group d-md-block border-0"},h=["onClick"],g={class:"row col-lg-9 mx-0"},p=["src","alt"],v={class:"card-body"},m={class:"card-title"},k={class:"card-text"},y={class:"d-flex"},f={class:"card-text align-self-center"},b=["onClick"],L=["onClick"],C=(0,i.Lk)("i",{class:"bi bi-cart3"},null,-1),$=[C],I=(0,i.Lk)("div",{class:"card-footer border-0"},[(0,i.Lk)("button",{type:"button",class:"btn btn-secondary w-100"}," 查看更多 ")],-1);function D(t,e,s,C,D,x){const w=(0,i.g2)("LoadingOverlay"),P=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(w,{active:D.isLoading,loader:"dots"},null,8,["active"]),o,(0,i.Lk)("div",l,[(0,i.Lk)("div",c,[(0,i.Lk)("div",d,[(0,i.Lk)("div",u,[(0,i.Lk)("div",n,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(D.productsCategory,((t,e)=>((0,i.uX)(),(0,i.CE)("a",{href:"#",class:(0,a.C4)(["list-group-item list-group-item-action border-0 rounded-5 mb-2 list-group-item-secondary",{active:D.selectedTitle===e}]),key:"value"+e,onClick:(0,r.D$)((t=>x.selectedCategory(e)),["prevent"])},(0,a.v_)("All"===e?"全部商品":e)+" ("+(0,a.v_)(t)+") ",11,h)))),128))])])]),(0,i.Lk)("div",g,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(D.products,(e=>((0,i.uX)(),(0,i.CE)("div",{class:"col-lg-4 g-4",key:e.id},[(0,i.bF)(P,{to:{path:`/user/product/${e.id}`},class:"card border-0 shadow card-hover"},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{src:e.imageUrl,class:"card-img-top img-fluid object-fit-cover vh-30",alt:e.title},null,8,p),(0,i.Lk)("div",v,[(0,i.Lk)("h5",m,(0,a.v_)(e.title),1),(0,i.Lk)("p",k,(0,a.v_)(e.category),1),(0,i.Lk)("div",y,[(0,i.Lk)("span",f," NT$"+(0,a.v_)(t.$filters.currency(e.price)),1),(0,i.Lk)("button",{type:"button",class:"btn btn-light ms-auto",onClick:(0,r.D$)((t=>x.addToFavorite(e)),["prevent"])},[(0,i.Lk)("i",{class:(0,a.C4)(["bi",D.favoriteID.includes(e.id)?"bi-heart-fill":"bi-heart"])},null,2)],8,b),(0,i.Lk)("button",{type:"button",class:"btn btn-light ms-2",onClick:(0,r.D$)((t=>x.addCart(e.id)),["prevent"])},$,8,L)])]),I])),_:2},1032,["to"])])))),128))])])])],64)}s(4114);var x={data(){return{isLoading:!1,products:[],allProducts:[],productsCategory:{},selectedTitle:"All",cart:{},message:"",favorite:JSON.parse(localStorage.getItem("favorite"))||[],favoriteID:JSON.parse(localStorage.getItem("favoriteID"))||[]}},inject:["emitter"],methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/angelvue/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,this.allProducts=[...this.products],this.isLoading=!1,this.sumProductsCategory(),this.$route.query.data&&this.selectedCategory(this.$route.query.data)})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`載入失敗, ${t.message}`})}))},sumProductsCategory(){this.productsCategory=this.products.reduce(((t,e)=>(t[e.category]=(t[e.category]||0)+1,t.All=(t.All||0)+1,t)),{All:0})},selectedCategory(t){this.selectedTitle=t,this.products="All"===t?[...this.allProducts]:this.allProducts.filter((e=>e.category===t))},addCart(t){const e="https://vue3-course-api.hexschool.io/api/angelvue/cart";this.isLoading=!0;const s={data:{product_id:t,qty:1}};this.$http.post(e,s).then((t=>{this.isLoading=!1,this.emitter.emit("update-cart"),this.$httpMessageState(t,`${t.data.data.product.title} 加入購物車`)})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`加入購物車失敗, ${t.message}`})}))},addToFavorite(t){const e=this.favoriteID.indexOf(t.id);-1===e?(this.favorite.push(t),this.favoriteID.push(t.id),this.emitter.emit("push-message",{style:"success",title:`已將${t.title}新增至收藏`})):(this.favorite.splice(e,1),this.favoriteID.splice(e,1),this.emitter.emit("push-message",{style:"danger",title:`已將${t.title}移除收藏`})),localStorage.setItem("favorite",JSON.stringify(this.favorite)),localStorage.setItem("favoriteID",JSON.stringify(this.favoriteID)),this.emitter.emit("update-favorite")}},created(){this.getProducts()}},w=s(6262);const P=(0,w.A)(x,[["render",D]]);var S=P}}]);
//# sourceMappingURL=688.c2d319b5.js.map