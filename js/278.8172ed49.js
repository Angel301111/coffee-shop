"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[278],{8314:function(t,e,o){o.d(e,{A:function(){return C}});var s=o(641),a=o(33);const l={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog",role:"document"},d={class:"modal-content border-0"},i=(0,s.Lk)("div",{class:"modal-header bg-danger text-white"},[(0,s.Lk)("h5",{class:"modal-title"},[(0,s.Lk)("span",null,"刪除")]),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),p={class:"modal-body"},u={class:"text-danger"},c={class:"modal-footer"},r=(0,s.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function h(t,e,o,h,m,b){return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",n,[(0,s.Lk)("div",d,[i,(0,s.Lk)("div",p,[(0,s.eW)(" 確定要刪除 "),(0,s.Lk)("strong",u,(0,a.v_)(o.item.title)+"?",1),(0,s.eW)(" (刪除後將無法恢復)。 ")]),(0,s.Lk)("div",c,[r,(0,s.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-item"))}," 確認刪除 ")])])])],512)}var m=o(3286),b={props:{item:{}},data(){return{modal:""}},mixins:[m.A]},k=o(6262);const L=(0,k.A)(b,[["render",h]]);var C=L},2278:function(t,e,o){o.r(e),o.d(e,{default:function(){return P}});var s=o(641),a=o(33);const l={class:"text-end mt-4"},n={class:"table-responsive"},d={class:"table mt-4"},i=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"名稱"),(0,s.Lk)("th",null,"優惠碼"),(0,s.Lk)("th",{class:"text-nowrap"},"折扣百分比"),(0,s.Lk)("th",null,"到期日"),(0,s.Lk)("th",{class:"text-nowrap"},"是否啟用"),(0,s.Lk)("th",null,"編輯")])],-1),p={class:"text-nowrap"},u={class:"text-nowrap"},c={class:"text-nowrap"},r={class:"text-nowrap"},h={class:"text-nowrap"},m={key:0,class:"text-success"},b={key:1,class:"text-muted"},k={class:"text-nowrap"},L={class:"btn-group"},C=["onClick"],g=["onClick"];function v(t,e,o,v,f,M){const y=(0,s.g2)("LoadingOverlay"),_=(0,s.g2)("CouponModal"),x=(0,s.g2)("DelModal");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(y,{active:f.isLoading},null,8,["active"]),(0,s.Lk)("div",l,[(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=t=>M.openCouponModal(!0))}," 建立新的優惠券 ")]),(0,s.Lk)("div",n,[(0,s.Lk)("table",d,[i,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.coupons,((e,o)=>((0,s.uX)(),(0,s.CE)("tr",{key:"item"+o},[(0,s.Lk)("td",p,(0,a.v_)(e.title),1),(0,s.Lk)("td",u,(0,a.v_)(e.code),1),(0,s.Lk)("td",c,(0,a.v_)(e.percent)+"%",1),(0,s.Lk)("td",r,(0,a.v_)(t.$filters.date(e.due_date)),1),(0,s.Lk)("td",h,[1===e.is_enabled?((0,s.uX)(),(0,s.CE)("span",m," 啟用 ")):((0,s.uX)(),(0,s.CE)("span",b,"未啟用"))]),(0,s.Lk)("td",k,[(0,s.Lk)("div",L,[(0,s.Lk)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:t=>M.openCouponModal(!1,e)}," 編輯 ",8,C),(0,s.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>M.openDelCouponModal(e)}," 刪除 ",8,g)])])])))),128))])])]),(0,s.bF)(_,{coupon:f.tempCoupon,ref:"couponModal",onUpdateCoupon:M.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,s.bF)(x,{item:f.tempCoupon,ref:"delModal",onDelItem:M.delCoupon},null,8,["item","onDelItem"])])}var f=o(3751);const M={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},y={class:"modal-dialog",role:"document"},_={class:"modal-content"},x=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠卷"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},w={class:"mb-3"},D=(0,s.Lk)("label",{for:"title"},"標題",-1),A={class:"mb-3"},E=(0,s.Lk)("label",{for:"coupon_code"},"優惠碼",-1),U={class:"mb-3"},X=(0,s.Lk)("label",{for:"due_date"},"到期日",-1),S={class:"mb-3"},V=(0,s.Lk)("label",{for:"price"},"折扣百分比",-1),F={class:"mb-3"},I={class:"form-check"},J=(0,s.Lk)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),N={class:"modal-footer"},O=(0,s.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function T(t,e,o,a,l,n){return(0,s.uX)(),(0,s.CE)("div",M,[(0,s.Lk)("div",y,[(0,s.Lk)("div",_,[x,(0,s.Lk)("div",$,[(0,s.Lk)("div",w,[D,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[0]||(e[0]=t=>l.tempCoupon.title=t),placeholder:"請輸入標題"},null,512),[[f.Jo,l.tempCoupon.title]])]),(0,s.Lk)("div",A,[E,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":e[1]||(e[1]=t=>l.tempCoupon.code=t),placeholder:"請輸入優惠碼"},null,512),[[f.Jo,l.tempCoupon.code]])]),(0,s.Lk)("div",U,[X,(0,s.bo)((0,s.Lk)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":e[2]||(e[2]=t=>l.due_date=t)},null,512),[[f.Jo,l.due_date]])]),(0,s.Lk)("div",S,[V,(0,s.bo)((0,s.Lk)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":e[3]||(e[3]=t=>l.tempCoupon.percent=t),placeholder:"請輸入折扣百分比"},null,512),[[f.Jo,l.tempCoupon.percent,void 0,{number:!0}]])]),(0,s.Lk)("div",F,[(0,s.Lk)("div",I,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[4]||(e[4]=t=>l.tempCoupon.is_enabled=t),id:"is_enabled"},null,512),[[f.lH,l.tempCoupon.is_enabled]]),J])])]),(0,s.Lk)("div",N,[O,(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[5]||(e[5]=e=>t.$emit("update-coupon",l.tempCoupon))}," 更新優惠券 ")])])])],512)}var W=o(3286),j={props:{coupon:{}},data(){return{tempCoupon:{},due_date:""}},watch:{coupon(){this.tempCoupon=this.coupon;const t=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=t[0]},due_date(){this.tempCoupon.due_date=new Date(this.due_date)/1e3}},mixins:[W.A]},H=o(6262);const K=(0,H.A)(j,[["render",T]]);var q=K,z=o(8314),B={components:{CouponModal:q,DelModal:z.A},inject:["emitter"],data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isLoading:!1,isNew:!1}},methods:{openCouponModal(t,e){this.tempCoupon=t?{due_date:(new Date).getTime()/1e3,is_enabled:0}:{...e},this.isNew=t,this.$refs.couponModal.showModal()},openDelCouponModal(t){this.tempCoupon={...t};const e=this.$refs.delModal;e.showModal()},getCoupons(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/angelvue/admin/coupons";this.$http.get(t).then((t=>{this.coupons=t.data.coupons,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`載入失敗, ${t.message}`})}))},updateCoupon(t){if(this.tempCoupon=t,this.isNew){const t="https://vue3-course-api.hexschool.io/api/angelvue/admin/coupon";this.isLoading=!0,this.$http.post(t,{data:this.tempCoupon}).then((t=>{this.isLoading=!1,this.$refs.couponModal.hideModal(),this.getCoupons(),this.$httpMessageState(t,"新增優惠券")})).catch((t=>{this.isLoading=!1,this.$refs.couponModal.hideModal(),this.emitter.emit("push-message",{style:"danger",title:`新增優惠券失敗, ${t.message}`})}))}else{const t=`https://vue3-course-api.hexschool.io/api/angelvue/admin/coupon/${this.tempCoupon.id}`;this.isLoading=!0,this.$http.put(t,{data:this.tempCoupon}).then((t=>{this.isLoading=!1,this.$refs.couponModal.hideModal(),this.getCoupons(),this.$httpMessageState(t,"更新優惠券")})).catch((t=>{this.isLoading=!1,this.$refs.couponModal.hideModal(),this.emitter.emit("push-message",{style:"danger",title:`更新優惠券失敗, ${t.message}`})}))}},delCoupon(){const t=`https://vue3-course-api.hexschool.io/api/angelvue/admin/coupon/${this.tempCoupon.id}`;this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$refs.delModal.hideModal(),this.getCoupons(),this.$httpMessageState(t,"刪除優惠券")})).catch((t=>{this.$refs.delModal.hideModal(),this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`刪除優惠券失敗, ${t.message}`})}))}},created(){this.getCoupons()}};const G=(0,H.A)(B,[["render",v]]);var P=G}}]);
//# sourceMappingURL=278.8172ed49.js.map