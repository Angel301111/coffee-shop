"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[662],{8662:function(t,e,s){s.r(e),s.d(e,{default:function(){return ot}});var a=s(641),l=s(33),i=s(3751);const o=(0,a.Lk)("header",{class:"p-5 text-center bg cart-header-background"},[(0,a.Lk)("h1",{class:"display-1 fw-bold text-light"},"My cart")],-1),n={class:"container"},d={class:"row justify-content-center"},r={class:"col-lg-10"},c=(0,a.Lk)("h2",{class:"text-center my-4 h3"},"─ 結帳流程 ─",-1),u=(0,a.Lk)("div",{class:"progress mb-4",style:{height:"30px"}},[(0,a.Lk)("div",{class:"progress-bar bg-secondary",role:"progressbar",style:{width:"25%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"}," 確認產品 ")],-1),h={class:"table-responsive"},p={class:"table align-middle"},k=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"text-center"},[(0,a.Lk)("th",null,"產品"),(0,a.Lk)("th",null,"名稱"),(0,a.Lk)("th",null,"數量"),(0,a.Lk)("th",{class:"text-nowrap"},"單價"),(0,a.Lk)("th")])],-1),m=["src","alt"],b={class:"text-nowrap"},g={key:0,class:"text-success"},L={class:"text-nowrap"},y=(0,a.Lk)("label",{for:"buy-quantity"},null,-1),v=["onClick","disabled"],f=(0,a.Lk)("i",{class:"bi bi-dash-circle-fill link-secondary fs-4"},null,-1),C=[f],x=["onUpdate:modelValue"],$=["onClick"],_=(0,a.Lk)("i",{class:"bi bi-plus-circle-fill link-secondary fs-4"},null,-1),M=[_],w={class:"text-nowrap"},q={key:0,class:"text-success"},A=["disabled","onClick"],I=(0,a.Lk)("i",{class:"bi bi-trash-fill"},null,-1),E=[I],F={class:"text-start",colspan:"3"},X=(0,a.Lk)("td",{colspan:"1",class:"text-end"},"總計",-1),D={class:"text-end"},Q={key:0},W=(0,a.Lk)("td",null,null,-1),j=(0,a.Lk)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),K={class:"text-end text-success"},S={class:"input-group my-3 input-group-sm"},U={class:"input-group-append"},V={class:"py-5 d-flex justify-content-center"},J=(0,a.Lk)("p",{class:"fs-3 text-center my-5"},"目前購物車是空的喔 Σ(っ°Д°;)っ",-1),R={class:"d-flex justify-content-center"};function O(t,e,s,f,_,I){const O=(0,a.g2)("LoadingOverlay"),z=(0,a.g2)("router-link"),B=(0,a.g2)("CartDelModal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(O,{active:_.isLoading,loader:"dots"},null,8,["active"]),o,(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[(0,a.Lk)("div",r,[Array.isArray(_.cart.carts)&&_.cart.carts[0]?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[c,u,(0,a.Lk)("div",h,[(0,a.Lk)("table",p,[k,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.cart.carts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"text-center"},[(0,a.Lk)("td",null,[(0,a.Lk)("img",{src:e.product.imageUrl,alt:e.product.title,class:"rounded product-img"},null,8,m)]),(0,a.Lk)("td",b,[(0,a.eW)((0,l.v_)(e.product.title)+" ",1),e.coupon?((0,a.uX)(),(0,a.CE)("div",g," 已套用優惠券 ")):(0,a.Q3)("",!0)]),(0,a.Lk)("td",L,[(0,a.Lk)("div",null,[y,(0,a.Lk)("button",{class:"btn",type:"button",onClick:t=>I.updateQuantity("minus",e),disabled:e.id===_.status.loadingItem||1===e.qty},C,8,v),(0,a.bo)((0,a.Lk)("input",{style:{width:"2rem"},class:"quantity-input",type:"text",name:"buy-quantity",id:"buy-quantity",value:"1",min:"1","onUpdate:modelValue":t=>e.qty=t,readonly:""},null,8,x),[[i.Jo,e.qty,void 0,{number:!0}]]),(0,a.Lk)("button",{class:"btn",type:"button",onClick:t=>I.updateQuantity("plus",e)},M,8,$)])]),(0,a.Lk)("td",w,[_.cart.final_total!==_.cart.total?((0,a.uX)(),(0,a.CE)("small",q," 折扣價： ")):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,l.v_)(t.$filters.currency(e.final_total)),1)]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:_.status.loadingItem===e.id,onClick:t=>I.removeCartItem(e)},E,8,A)])])))),128))]),(0,a.Lk)("tfoot",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",F,[(0,a.Lk)("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:e[0]||(e[0]=(...t)=>I.openDelAllModal&&I.openDelAllModal(...t))}," 全部刪除 ")]),X,(0,a.Lk)("td",D,(0,l.v_)(t.$filters.currency(_.cart.total)),1)]),_.cart.final_total!==_.cart.total?((0,a.uX)(),(0,a.CE)("tr",Q,[W,j,(0,a.Lk)("td",K,(0,l.v_)(t.$filters.currency(_.cart.final_total)),1)])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",S,[(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control input-border","onUpdate:modelValue":e[1]||(e[1]=t=>_.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[i.Jo,_.coupon_code]]),(0,a.Lk)("div",U,[(0,a.Lk)("button",{class:"btn btn-outline-secondary btn-border",type:"button",onClick:e[2]||(e[2]=(...t)=>I.addCouponCode&&I.addCouponCode(...t))}," 使用優惠碼 ")])]),(0,a.Lk)("div",V,[(0,a.bF)(z,{to:"/user/productlist",class:"btn btn-outline-dark me-2"},{default:(0,a.k6)((()=>[(0,a.eW)(" 繼續購物 ")])),_:1}),(0,a.bF)(z,{to:"/user/orderform",class:"btn btn-dark ms-2"},{default:(0,a.k6)((()=>[(0,a.eW)(" 填寫訂購資訊 ")])),_:1})])],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[J,(0,a.Lk)("div",R,[(0,a.bF)(z,{to:"/user/productlist",class:"btn btn-dark"},{default:(0,a.k6)((()=>[(0,a.eW)(" 馬上來杯咖啡吧！ ")])),_:1})])],64))])])]),(0,a.bF)(B,{ref:"cartdelModal",onRemoveAll:I.removeAll},null,8,["onRemoveAll"])],64)}const z={class:"modal fade",id:"cartDelModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},B={class:"modal-dialog",role:"document"},G={class:"modal-content border-0"},H=(0,a.Lk)("div",{class:"modal-header bg-danger text-white"},[(0,a.Lk)("h5",{class:"modal-title"},[(0,a.Lk)("span",null,"刪除")]),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),N=(0,a.Lk)("div",{class:"modal-body"},"確定要刪除全部嗎？ (刪除後將無法恢復)。",-1),P={class:"modal-footer"},T=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Y(t,e,s,l,i,o){return(0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("div",B,[(0,a.Lk)("div",G,[H,N,(0,a.Lk)("div",P,[T,(0,a.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("remove-all"))}," 確認刪除 ")])])])],512)}var Z=s(3286),tt={data(){return{modal:""}},mixins:[Z.A]},et=s(6262);const st=(0,et.A)(tt,[["render",Y]]);var at=st,lt={data(){return{product:{},isLoading:!1,status:{loadingItem:""},cart:{},coupon_code:""}},components:{CartDelModal:at},inject:["emitter"],methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/angelvue/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`載入失敗, ${t.message}`})}))},updateQuantity(t,e){this.status.loadingItem=e.id;const s=this.cart.carts.filter((t=>t.id===e.id));s.forEach((s=>{"plus"===t?(s.qty+=1,this.updateCart(e)):s.qty>1&&(s.qty-=1,this.updateCart(e)),this.status.loadingItem=""}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/angelvue/cart/${t.id}`;this.status.loadingItem=t.id,this.isLoading=!0;const s={data:{product_id:t.product_id,qty:t.qty}};this.$http.put(e,s).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.$httpMessageState(t,"更新購物車"),this.getCart()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`更新購物車失敗, ${t.message}`})}))},removeCartItem(t){const e=`https://vue3-course-api.hexschool.io/api/angelvue/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id,this.$http.delete(e).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.$httpMessageState(t,"刪除"),this.emitter.emit("update-cart"),this.getCart()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`刪除失敗, ${t.message}`})}))},openDelAllModal(){this.$refs.cartdelModal.showModal()},removeAll(){const t="https://vue3-course-api.hexschool.io/api/angelvue/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$refs.cartdelModal.hideModal(),this.$httpMessageState(t,"全部刪除"),this.emitter.emit("update-cart"),this.getCart()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`全部刪除失敗, ${t.message}`})}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/angelvue/coupon";this.isLoading=!0;const e={data:{code:this.coupon_code}};this.$http.post(t,e).then((t=>{this.isLoading=!1,this.$httpMessageState(t,"優惠卷使用"),this.getCart()})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`優惠卷使用失敗, ${t.message}`})}))}},created(){this.getCart()}};const it=(0,et.A)(lt,[["render",O]]);var ot=it}}]);
//# sourceMappingURL=662.d99039e7.js.map